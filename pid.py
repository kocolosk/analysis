from bisect import bisect

_calib = {
6988 : ( 0.066608, 0.889596),
6990 : ( 0.028513, 0.872612),
6992 : ( 0.016085, 0.856032),
6994 : ( 0.076727, 0.867838),
6995 : ( 0.167452, 0.855377),
6997 : ( 0.206903, 0.882462),
6998 : (-0.018938, 0.844754),
7001 : (-0.006526, 0.863949),
7002 : ( 0.014921, 0.865907),
7032 : (-0.059741, 0.856267),
7034 : (-0.064317, 0.870471),
7035 : (-0.090822, 0.871124),
7048 : (-0.387454, 0.866186),
7049 : (-0.393791, 0.865776),
7051 : (-0.137894, 0.792171),
7055 : (-0.420703, 0.858151),
7064 : (-0.283141, 0.878024),
7067 : (-0.087372, 0.873845),
7068 : (-0.077816, 0.840146),
7069 : ( 0.010756, 0.861486),
7070 : (-0.054644, 0.879342),
7072 : (-0.022931, 0.863193),
7075 : (-0.065000, 0.814292),
7079 : (-0.261988, 0.896589),
7085 : (-0.207958, 0.879845),
7087 : (-0.062486, 0.818310),
7088 : (-0.184964, 0.869739),
7092 : (-0.095016, 0.879631),
7102 : (-0.161471, 0.899666),
7103 : (-0.180760, 0.900305),
7110 : (-0.194342, 0.894236),
7112 : (-0.116899, 0.878893),
7114 : (-0.140619, 0.871448),
7118 : (-0.206615, 0.883038),
7120 : (-0.096027, 0.884061),
7122 : (-0.187495, 0.903031),
7123 : (-0.172261, 0.885190),
7124 : (-0.175057, 0.906155),
7125 : (-0.134531, 0.887071),
#7127 : (-0.149092, 0.897838), ## RunLog_onl problem
7128 : (-0.149092, 0.897838),
7131 : (-0.197370, 0.889249),
7133 : (-0.207133, 0.888365),
#7134 : (-0.130486, 0.893232), ## RunLog_onl problem
7134 : (-0.119566, 0.901472),
7136 : (-0.026902, 0.621362),
7138 : (-0.150951, 0.892991),
7151 : ( 0.033011, 0.851425),
7153 : (-0.094305, 0.892003),
7154 : ( 0.010605, 0.824362),
7161 : (-0.167815, 0.894401),
7162 : (-0.152793, 0.906894),
7164 : (-0.125891, 0.894419),
7165 : (-0.162527, 0.870979),
7166 : (-0.133315, 0.884772),
7172 : (-0.207923, 0.894637),
7232 : (-0.110842, 0.864740),
7237 : (-0.269559, 0.916554),
7238 : (-0.259372, 0.891293),
7249 : (-0.247810, 0.894708),
7250 : (-0.316081, 0.909442),
7253 : (-0.271044, 0.845922),
7255 : (-0.249242, 0.857201),
7265 : (-0.190056, 0.865755),
7266 : (-0.243196, 0.869884),
7269 : (-0.242802, 0.892759),
7270 : (-0.314700, 0.886310),
7271 : (-0.389984, 0.910892),
7272 : (-0.194932, 0.883244),
7274 : (-0.344731, 0.903323),
7276 : (-0.198418, 0.897573),
7278 : (-0.273830, 0.875383),
7279 : (-0.219441, 0.895625),
7293 : (-0.346773, 0.803589), ## transverse
7295 : (-0.268542, 0.859643), ## transverse
7296 : (-0.328538, 0.901968), ## transverse
7300 : (-0.283700, 0.876021),
7301 : (-0.325708, 0.891317),
7302 : (-0.333164, 0.890520),
7303 : (-0.274641, 0.894173),
7304 : (-0.306279, 0.890682),
7305 : ( 0.726845, 0.934432),
7308 : (-0.297895, 0.913868),
7311 : (-0.232436, 0.905442),
7317 : (-0.301910, 0.886113),
7320 : (-0.229533, 0.893824),
7325 : (-0.251390, 0.898416),
7327 : (-0.251943, 0.895118),
7718 : (-0.077766, 0.879930),  ## transverse
7722 : (-0.019419, 0.848818),  ## transverse
7724 : (-0.115915, 0.875705),  ## transverse
7725 : (-0.089028, 0.869330),  ## transverse
7729 : (-0.149134, 0.896646),  ## transverse
7739 : (-0.092455, 0.885406),  ## transverse
7740 : (-0.108566, 0.891201),  ## transverse
7744 : (-0.051341, 0.894509),  ## transverse
7745 : (-0.072091, 0.864465),  ## transverse
7753 : (-0.051187, 0.889440),  ## transverse
7756 : ( 0.151309, 0.848012),  ## transverse
7757 : (-0.108126, 0.880723),  ## transverse
7781 : (-0.045714, 0.907452),  ## transverse
7785 : ( 0.079990, 0.866071),  ## transverse
7786 : (-0.043541, 0.882520),  ## transverse
7788 : ( 0.063298, 0.888150),  ## transverse
7789 : (-0.115123, 0.894880),  ## transverse
7790 : (-0.163721, 0.903411),  ## transverse
7791 : (-0.107792, 0.909530),  ## transverse
7792 : (-0.058317, 0.892502),  ## transverse
7794 : (-0.062679, 0.903440),  ## transverse
7795 : (-0.120403, 0.904253),  ## transverse
7796 : (-0.208192, 0.927860),  ## transverse
7797 : (-0.157988, 0.910834),  ## transverse
7800 : (-0.135945, 0.889122),  ## transverse
7803 : (-0.024001, 0.873819),  ## transverse
7804 : (-0.253835, 0.897332),  ## transverse
7805 : (-0.176320, 0.895462),  ## transverse
7810 : (-0.084868, 0.877880),  ## transverse
7811 : (-0.157192, 0.863181),  ## transverse
7815 : (-0.270277, 0.898946),  ## transverse
7817 : (-0.196213, 0.880809),  ## transverse
7820 : (-0.238482, 0.899890),  ## transverse
7823 : (-0.247331, 0.894104),  ## transverse
7824 : (-0.278816, 0.909190),  ## transverse
7825 : (-0.174100, 0.886618),  ## transverse
7826 : (-0.234116, 0.887850),  ## transverse
7827 : (-0.171585, 0.863359),  ## transverse
7830 : (-0.238725, 0.895052),  ## transverse
7831 : (-0.222429, 0.897187),  ## transverse
7847 : (-0.027059, 0.874814),
7850 : (-0.123179, 0.900492),
7851 : (-0.036289, 0.889293),
7852 : (-0.045614, 0.891709),
7853 : (-0.119185, 0.898291),
7855 : (-0.134738, 0.908692),
7856 : (-0.089265, 0.895362),
7858 : (-0.102251, 0.897319),
7863 : (-0.083709, 0.911717),
7864 : (-0.113995, 0.904617),
7865 : ( 0.009516, 0.813364),
7871 : (-0.109983, 0.906486),
7872 : (-0.138412, 0.882469),
7883 : (-0.182051, 0.885964),
7886 : (-0.185474, 0.889406),
7887 : (-0.155607, 0.886540),
7889 : (-0.100630, 0.863594),
7890 : (-0.053211, 0.921421),
7891 : (-0.099581, 0.861152),
7892 : (-0.077996, 0.892110),
7893 : (-0.123162, 0.907638),
7896 : (-0.094806, 0.894019),
7898 : (-0.057477, 0.896248),
7901 : (-0.014140, 0.865671),
7908 : (-0.040456, 0.883598),
7909 : (-0.077470, 0.880354),
7911 : (-0.048150, 0.861430),
7913 : (-0.076636, 0.896822),
7916 : (-0.078441, 0.894539),
7918 : ( 0.043434, 0.888361),
7921 : (-0.010669, 0.876733),
7922 : ( 0.022409, 0.907525),
7926 : (-0.033154, 0.886284),
7944 : (-0.068744, 0.905098),
7949 : (-0.039570, 0.876990),
7951 : ( 0.056927, 0.936951),
7952 : ( 0.025446, 0.885525),
7954 : ( 0.205871, 0.864685),
7957 : ( 0.014065, 0.899964)
}

## retrieve start_run -> fill mapping from RunLog_onl by
# SELECT blueFillNumber, MIN(runNumber) FROM beamInfo 
#     WHERE runNumber>6119000 AND runNumber<8000000 AND deactive=0 
#     GROUP BY blueFillNumber;
_first_run = (
( 6119001, 6988 ),
( 6119043, 6989 ),
( 6119048, 6990 ),
( 6119074, 6991 ),
( 6120001, 6992 ),
( 6120025, 6994 ),
( 6120057, 6995 ),
( 6121001, 6997 ),
( 6121026, 6998 ),
( 6121038, 6999 ),
( 6121050, 7001 ),
( 6122004, 7002 ),
( 6122025, 7005 ),
( 6122042, 7007 ),
( 6123030, 7008 ),
( 6123033, 7010 ),
( 6125001, 7021 ),
( 6125012, 7023 ),
( 6125013, 7024 ),
( 6126001, 7028 ),
( 6126055, 7029 ),
( 6127002, 7030 ),
( 6127020, 7032 ),
( 6127049, 7034 ),
( 6128035, 7035 ),
( 6128065, 7036 ),
( 6129001, 7038 ),
( 6129002, 7039 ),
( 6129011, 7040 ),
( 6129017, 7041 ),
( 6129021, 7044 ),
( 6130002, 7046 ),
( 6130041, 7047 ),
( 6130044, 7048 ),
( 6131001, 7049 ),
( 6131064, 7051 ),
( 6131099, 7053 ),
( 6131104, 7055 ),
( 6132027, 7059 ),
( 6132030, 7060 ),
( 6132105, 7063 ),
( 6132109, 7064 ),
( 6133034, 7065 ),
( 6133039, 7067 ),
( 6134016, 7068 ),
( 6134049, 7069 ),
( 6134073, 7070 ),
( 6135016, 7072 ),
( 6135039, 7073 ),
( 6135043, 7075 ),
( 6136001, 7079 ),
( 6136044, 7081 ),
( 6136045, 7082 ),
( 6136048, 7084 ),
( 6136078, 7085 ),
( 6137059, 7086 ),
( 6137132, 7087 ),
( 6137151, 7088 ),
( 6138006, 7092 ),
( 6138021, 7093 ),
( 6138029, 7094 ),
( 6138044, 7096 ),
( 6138048, 7102 ),
( 6139014, 7103 ),
( 6139042, 7110 ),
( 6140006, 7112 ),
( 6140043, 7113 ),
( 6140047, 7114 ),
( 6141001, 7115 ),
( 6141004, 7118 ),
( 6141034, 7119 ),
( 6141040, 7120 ),
( 6141070, 7122 ),
( 6142028, 7123 ),
( 6142065, 7124 ),
( 6143004, 7125 ),
( 6143036, 7126 ),
( 6143043, 7127 ),
( 6144002, 7128 ), ## missing from RunLog_onl DB
( 6144041, 7129 ), ## missing from RunLog_onl DB
( 6144043, 7131 ),
( 6145001, 7133 ),
( 6145030, 7134 ),
( 6145067, 7136 ), ## missing from RunLog_onl DB
( 6146001, 7138 ), ## missing from RunLog_onl DB
( 6146027, 7139 ),
( 6146030, 7140 ),
( 6146033, 7142 ),
( 6146046, 7143 ),
( 6147002, 7151 ),
( 6147033, 7152 ),
( 6148002, 7153 ),
( 6148028, 7154 ),
( 6148042, 7156 ),
( 6148046, 7161 ),
( 6149010, 7162 ),
( 6149038, 7163 ),
( 6149041, 7164 ),
( 6149058, 7165 ),
( 6150007, 7166 ),
( 6150030, 7172 ),
( 6153001, 7210 ),
( 6153002, 7212 ),
( 6153003, 7213 ),
( 6153004, 7214 ),
( 6153005, 7215 ),
( 6153012, 7216 ),
( 6153013, 7218 ),
( 6153015, 7219 ),
( 6153022, 7222 ),
( 6153023, 7223 ),
( 6154018, 7224 ),
( 6154046, 7232 ),
( 6155005, 7233 ),
( 6155007, 7234 ),
( 6155014, 7237 ),
( 6156020, 7238 ),
( 6156046, 7240 ),
( 6157001, 7241 ),
( 6157028, 7246 ),
( 6157042, 7249 ),
( 6158026, 7250 ),
( 6158043, 7253 ),
( 6158066, 7255 ),
( 6159001, 7260 ),
( 6159052, 7263 ),
( 6160018, 7264 ),
( 6160032, 7265 ),
( 6160074, 7266 ),
( 6161010, 7268 ),
( 6161016, 7269 ),
( 6161060, 7270 ),
( 6162008, 7271 ),
( 6162015, 7272 ),
( 6162048, 7273 ),
( 6162052, 7274 ),
( 6163001, 7276 ),
( 6163031, 7278 ),
( 6164006, 7279 ),
( 6164029, 7280 ),
( 6165002, 7287 ),
( 6165004, 7288 ),
( 6165005, 7289 ),
( 6165006, 7291 ),
( 6165008, 7292 ),
( 6165015, 7293 ),
( 6165066, 7294 ),
( 6166035, 7295 ),
( 6166078, 7296 ),
( 6167089, 7297 ),
( 6167090, 7298 ),
( 6167097, 7299 ),
( 6167098, 7300 ),
( 6168010, 7301 ),
( 6168059, 7302 ),
( 6169009, 7303 ),
( 6169061, 7304 ),
( 6170020, 7305 ),
( 6170063, 7306 ),
( 6171014, 7308 ),
( 6171051, 7309 ),
( 6171054, 7311 ),
( 6172017, 7313 ),
( 6172028, 7315 ),
( 6172055, 7317 ),
( 6173002, 7318 ),
( 6173045, 7319 ),
( 6174001, 7320 ),
( 6174032, 7321 ),
( 6174036, 7325 ),
( 6175001, 7327 ),
( 7096047, 7718 ),
( 7097057, 7719 ),
( 7097073, 7722 ),
( 7098009, 7724 ),
( 7098044, 7725 ),
( 7099007, 7729 ),
( 7099063, 7731 ),
( 7099076, 7732 ),
( 7100001, 7738 ),
( 7100004, 7739 ),
( 7100032, 7740 ),
( 7101005, 7742 ),
( 7101007, 7744 ),
( 7101060, 7745 ),
( 7102001, 7747 ),
( 7102057, 7748 ),
( 7103001, 7753 ),
( 7103041, 7754 ),
( 7103046, 7755 ),
( 7103047, 7756 ),
( 7104006, 7757 ),
( 7104019, 7759 ),
( 7113006, 7775 ),
( 7113013, 7776 ),
( 7114005, 7777 ),
( 7114021, 7778 ),
( 7114033, 7780 ),
( 7115070, 7781 ),
( 7116001, 7782 ),
( 7116006, 7784 ),
( 7116019, 7785 ),
( 7117022, 7786 ),
( 7117038, 7788 ),
( 7118019, 7789 ),
( 7118060, 7790 ),
( 7119007, 7791 ),
( 7119042, 7792 ),
( 7119093, 7793 ),
( 7120002, 7794 ),
( 7120056, 7795 ),
( 7120102, 7796 ),
( 7121003, 7797 ),
( 7121046, 7798 ),
( 7121087, 7799 ),
( 7121098, 7800 ),
( 7122008, 7801 ),
( 7122021, 7803 ),
( 7122061, 7804 ),
( 7123001, 7805 ),
( 7123047, 7806 ),
( 7123049, 7807 ),
( 7123064, 7810 ),
( 7124035, 7811 ),
( 7124075, 7812 ),
( 7124091, 7813 ),
( 7124109, 7814 ),
( 7124115, 7815 ),
( 7125030, 7816 ),
( 7125032, 7817 ),
( 7125073, 7819 ),
( 7126002, 7820 ),
( 7126040, 7821 ),
( 7126045, 7822 ),
( 7126046, 7823 ),
( 7127015, 7824 ),
( 7127053, 7825 ),
( 7127082, 7826 ),
( 7128015, 7827 ),
( 7128033, 7828 ),
( 7128038, 7830 ),
( 7129011, 7831 ),
( 7129045, 7833 ),
( 7130002, 7838 ),
( 7131001, 7842 ),
( 7131004, 7844 ),
( 7131009, 7846 ),
( 7131015, 7847 ),
( 7132029, 7849 ),
( 7132034, 7850 ),
( 7133001, 7851 ),
( 7133027, 7852 ),
( 7133055, 7853 ),
( 7134018, 7854 ),
( 7134019, 7855 ),
( 7134058, 7856 ),
( 7135006, 7858 ),
( 7135032, 7859 ),
( 7135037, 7860 ),
( 7136009, 7861 ),
( 7136010, 7863 ),
( 7136047, 7864 ),
( 7137002, 7865 ),
( 7137017, 7866 ),
( 7137029, 7871 ),
( 7138018, 7872 ),
( 7138046, 7873 ),
( 7138049, 7874 ),
( 7138052, 7876 ),
( 7138066, 7877 ),
( 7139002, 7878 ),
( 7139003, 7882 ),
( 7139007, 7883 ),
( 7140001, 7886 ),
( 7140025, 7887 ),
( 7141001, 7889 ),
( 7141027, 7890 ),
( 7141049, 7891 ),
( 7142007, 7892 ),
( 7142038, 7893 ),
( 7142053, 7896 ),
( 7143032, 7897 ),
( 7143037, 7898 ),
( 7144003, 7901 ),
( 7144019, 7903 ),
( 7144034, 7904 ),
( 7144052, 7906 ),
( 7145002, 7908 ),
( 7145045, 7909 ),
( 7146011, 7911 ),
( 7146026, 7913 ),
( 7146083, 7915 ),
( 7147037, 7916 ),
( 7148001, 7917 ),
( 7148003, 7918 ),
( 7148047, 7921 ),
( 7149007, 7922 ),
( 7150002, 7926 ),
( 7150026, 7929 ),
( 7150034, 7930 ),
( 7151002, 7936 ),
( 7152001, 7940 ),
( 7152025, 7944 ),
( 7153085, 7946 ),
( 7153097, 7949 ),
( 7154058, 7950 ),
( 7154062, 7951 ),
( 7155001, 7952 ),
( 7155029, 7953 ),
( 7155031, 7954 ),
( 7156001, 7957 ),
( 7156046, 7959 ),
( 7157001, 7962 ),
( 7158001, 7994 ),
( 7158015, 7995 ),
( 7158020, 7996 ),
( 7159002, 7998 ),
( 7159014, 7999 ),
( 7159064, 8003 ),
( 7160017, 8005 ),
( 7160041, 8007 ),
( 7160047, 8008 ),
( 7160056, 8010 ),
( 7160065, 8014 ),
( 7161005, 8015 ),
( 7161025, 8016 ),
( 7162001, 8021 ),
( 7162015, 8022 ),
( 7162033, 8023 ),
( 7163028, 8024 ),
( 7163037, 8025 ),
( 7163044, 8026 ),
( 7163064, 8027 ),
( 7164001, 8030 ),
( 7164003, 8031 ),
( 7164034, 8032 ),
( 7165001, 8035 ),
( 7166001, 8036 ),
( 7166031, 8037 ),
( 7167001, 8040 ),
( 7167002, 8047 ),
( 7167015, 8048 ),
( 7167022, 8049 ),
( 7168010, 8051 ),
( 7168011, 8052 ),
( 7168018, 8054 ),
( 7169027, 8055 ),
( 7169040, 8056 ),
( 7170025, 8057 ),
( 7170031, 8058 ),
( 7171001, 8059 ),
( 7171021, 8060 ),
( 7171027, 8061 ),
( 7174001, 8092 ),
( 7175002, 8104 ),
( 7176001, 8107 ),
( 7346019, 8119 )
)
    
def min(run):
    mean, width = _calib[fill(run)]
    return mean - 1.0*width

def max(run):
    mean, width = _calib[fill(run)]
    return mean + 2.0*width
    
def fill(run):
    index = bisect(_first_run, (run, 9999)) - 1
    return _first_run[index][1]